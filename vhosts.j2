{% for vhost in vhosts %}
<VirtualHost *:{{ vhost.port }}>
  ...
  {% if vhost.directory %}
  <Directory "{{ vhost.directory }}">
     ...
  </Directory>
  {% endif %}
</VirtualHost>
{% endfor %}